# This file was generated by "weaver kube" version v0.24.8 for the following
# application:
#
#     app: server
#     version: ce77cf42
#     components groups:
#     - 
#       - codeathon.runwayclub.dev/internal/challenge/ChallengeService
#     - 
#       - codeathon.runwayclub.dev/internal/leaderboard/LeaderboardService
#     - 
#       - codeathon.runwayclub.dev/internal/profile/ProfileService
#     - 
#       - codeathon.runwayclub.dev/internal/submission/SubmissionService
#     - 
#       - github.com/ServiceWeaver/weaver/Main
#     listeners:
#     - server
#
# This file contains the following resources:
#
#     1. A Deployment for every group of components.
#     2. A HorizontalPodAutoscaler for every Deployment.
#     3. A Service for every listener.
#     4. Some Roles and RoleBindings to configure permissions.
#
# To deploy these resources, run:
#
#     kubectl apply -f /tmp/kube_ce77cf42.yaml
#
# To view the deployed resources, run:
#
#     kubectl get all,configmaps --selector=serviceweaver/version=ce77cf42
#
# To view a description of every resource, run:
#
#     kubectl get all,configmaps --selector=serviceweaver/version=ce77cf42 -o custom-columns=KIND:.kind,NAME:.metadata.name,APP:.metadata.labels.serviceweaver/app,VERSION:.metadata.labels.serviceweaver/version,DESCRIPTION:.metadata.annotations.description
#
# To delete the resources, run:
#
#     kubectl delete all,configmaps --selector=serviceweaver/version=ce77cf42


# Roles.
apiVersion: rbac.authorization.k8s.io/v1
kind: Role
metadata:
  creationTimestamp: null
  name: serviceweaver-pods-getter
  namespace: codeathon
rules:
- apiGroups:
  - ""
  resources:
  - pods
  verbs:
  - get
  - list
  - watch

---

# Role Bindings.
apiVersion: rbac.authorization.k8s.io/v1
kind: RoleBinding
metadata:
  creationTimestamp: null
  name: serviceweaver-default-pods-getter
  namespace: codeathon
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: Role
  name: serviceweaver-pods-getter
subjects:
- kind: ServiceAccount
  name: default
  namespace: codeathon

---

# Configuration
apiVersion: v1
data:
  config.textpb: |
    namespace:  "codeathon"
    deployment_id:  "ce77cf42-9852-4c18-85c4-4db12f5f9bb5"
    listeners:  {
      key:  "server"
      value:  20000
    }
    groups:  {
      key:  "codeathon.runwayclub.dev/internal/challenge/ChallengeService"
      value:  "codeathon.runwayclub.dev/internal/challenge/ChallengeService"
    }
    groups:  {
      key:  "codeathon.runwayclub.dev/internal/leaderboard/LeaderboardService"
      value:  "codeathon.runwayclub.dev/internal/leaderboard/LeaderboardService"
    }
    groups:  {
      key:  "codeathon.runwayclub.dev/internal/profile/ProfileService"
      value:  "codeathon.runwayclub.dev/internal/profile/ProfileService"
    }
    groups:  {
      key:  "codeathon.runwayclub.dev/internal/submission/SubmissionService"
      value:  "codeathon.runwayclub.dev/internal/submission/SubmissionService"
    }
    groups:  {
      key:  "github.com/ServiceWeaver/weaver/Main"
      value:  "github.com/ServiceWeaver/weaver/Main"
    }
    telemetry:  {
      metrics:  {
        export_interval:  {
          seconds:  30
        }
      }
    }
  weaver.toml: |
    [serviceweaver]
      name = "server"
      binary = "./server"
      args = ["--port", "8080"]
      colocate = [
      ["main/Rock", "main/Paper", "main/Scissors"],
      ["github.com/example/sandy/PeanutButter", "github.com/example/sandy/Jelly"],
    ]
      rollout = "1m"
    [single]
    listeners.server = {address = "0.0.0.0:8080"}
kind: ConfigMap
metadata:
  annotations:
    description: This ConfigMap contains config files for app "server" version "ce77cf42".
  creationTimestamp: null
  labels:
    serviceweaver/app: server
    serviceweaver/version: ce77cf42
  name: config-ce77cf42
  namespace: codeathon

---

# Deployment for group codeathon.runwayclub.dev/internal/challenge/ChallengeService
apiVersion: apps/v1
kind: Deployment
metadata:
  annotations:
    description: This Deployment hosts components codeathon.runwayclub.dev/internal/challenge/ChallengeService.
  creationTimestamp: null
  labels:
    serviceweaver/app: server
    serviceweaver/version: ce77cf42
  name: server-challenge-challengeservice-ce77cf42-25266546
  namespace: codeathon
spec:
  selector:
    matchLabels:
      serviceweaver/name: server-challenge-challengeservice-ce77cf42-25266546
  strategy: {}
  template:
    metadata:
      annotations:
        description: This Pod hosts components codeathon.runwayclub.dev/internal/challenge/ChallengeService.
      creationTimestamp: null
      labels:
        serviceweaver/app: server
        serviceweaver/name: server-challenge-challengeservice-ce77cf42-25266546
        serviceweaver/version: ce77cf42
      namespace: codeathon
    spec:
      affinity:
        podAntiAffinity:
          preferredDuringSchedulingIgnoredDuringExecution:
          - podAffinityTerm:
              labelSelector:
                matchLabels:
                  serviceweaver/name: server-challenge-challengeservice-ce77cf42-25266546
              topologyKey: kubernetes.io/hostname
            weight: 100
      containers:
      - args:
        - babysitter
        - /weaver/weaver.toml
        - /weaver/config.textpb
        - codeathon.runwayclub.dev/internal/challenge/ChallengeService
        image: docker.io/vominhtri1610/server:ce77cf42
        imagePullPolicy: IfNotPresent
        name: serviceweaver
        resources: {}
        stdin: true
        tty: true
        volumeMounts:
        - mountPath: /weaver/weaver.toml
          name: config
          subPath: weaver.toml
        - mountPath: /weaver/config.textpb
          name: config
          subPath: config.textpb
      dnsPolicy: ClusterFirst
      serviceAccountName: default
      volumes:
      - configMap:
          name: config-ce77cf42
        name: config
status: {}

---

# Autoscaler for group codeathon.runwayclub.dev/internal/challenge/ChallengeService
apiVersion: autoscaling/v2
kind: HorizontalPodAutoscaler
metadata:
  annotations:
    description: This HorizontalPodAutoscaler scales the "server-challenge-challengeservice-ce77cf42-25266546"
      Deployment.
  creationTimestamp: null
  labels:
    serviceweaver/app: server
    serviceweaver/version: ce77cf42
  name: server-challenge-challengeservice-ce77cf42-25266546
  namespace: codeathon
spec:
  maxReplicas: 10
  metrics:
  - resource:
      name: cpu
      target:
        averageUtilization: 80
        type: Utilization
    type: Resource
  minReplicas: 1
  scaleTargetRef:
    apiVersion: apps/v1
    kind: Deployment
    name: server-challenge-challengeservice-ce77cf42-25266546
status:
  currentMetrics: null
  desiredReplicas: 0

---

# Deployment for group codeathon.runwayclub.dev/internal/leaderboard/LeaderboardService
apiVersion: apps/v1
kind: Deployment
metadata:
  annotations:
    description: This Deployment hosts components codeathon.runwayclub.dev/internal/leaderboard/LeaderboardService.
  creationTimestamp: null
  labels:
    serviceweaver/app: server
    serviceweaver/version: ce77cf42
  name: server-leaderboard-leaderboardservice-ce77cf42-e42dcf73
  namespace: codeathon
spec:
  selector:
    matchLabels:
      serviceweaver/name: server-leaderboard-leaderboardservice-ce77cf42-e42dcf73
  strategy: {}
  template:
    metadata:
      annotations:
        description: This Pod hosts components codeathon.runwayclub.dev/internal/leaderboard/LeaderboardService.
      creationTimestamp: null
      labels:
        serviceweaver/app: server
        serviceweaver/name: server-leaderboard-leaderboardservice-ce77cf42-e42dcf73
        serviceweaver/version: ce77cf42
      namespace: codeathon
    spec:
      affinity:
        podAntiAffinity:
          preferredDuringSchedulingIgnoredDuringExecution:
          - podAffinityTerm:
              labelSelector:
                matchLabels:
                  serviceweaver/name: server-leaderboard-leaderboardservice-ce77cf42-e42dcf73
              topologyKey: kubernetes.io/hostname
            weight: 100
      containers:
      - args:
        - babysitter
        - /weaver/weaver.toml
        - /weaver/config.textpb
        - codeathon.runwayclub.dev/internal/leaderboard/LeaderboardService
        image: docker.io/vominhtri1610/server:ce77cf42
        imagePullPolicy: IfNotPresent
        name: serviceweaver
        resources: {}
        stdin: true
        tty: true
        volumeMounts:
        - mountPath: /weaver/weaver.toml
          name: config
          subPath: weaver.toml
        - mountPath: /weaver/config.textpb
          name: config
          subPath: config.textpb
      dnsPolicy: ClusterFirst
      serviceAccountName: default
      volumes:
      - configMap:
          name: config-ce77cf42
        name: config
status: {}

---

# Autoscaler for group codeathon.runwayclub.dev/internal/leaderboard/LeaderboardService
apiVersion: autoscaling/v2
kind: HorizontalPodAutoscaler
metadata:
  annotations:
    description: This HorizontalPodAutoscaler scales the "server-leaderboard-leaderboardservice-ce77cf42-e42dcf73"
      Deployment.
  creationTimestamp: null
  labels:
    serviceweaver/app: server
    serviceweaver/version: ce77cf42
  name: server-leaderboard-leaderboardservice-ce77cf42-e42dcf73
  namespace: codeathon
spec:
  maxReplicas: 10
  metrics:
  - resource:
      name: cpu
      target:
        averageUtilization: 80
        type: Utilization
    type: Resource
  minReplicas: 1
  scaleTargetRef:
    apiVersion: apps/v1
    kind: Deployment
    name: server-leaderboard-leaderboardservice-ce77cf42-e42dcf73
status:
  currentMetrics: null
  desiredReplicas: 0

---

# Deployment for group codeathon.runwayclub.dev/internal/profile/ProfileService
apiVersion: apps/v1
kind: Deployment
metadata:
  annotations:
    description: This Deployment hosts components codeathon.runwayclub.dev/internal/profile/ProfileService.
  creationTimestamp: null
  labels:
    serviceweaver/app: server
    serviceweaver/version: ce77cf42
  name: server-profile-profileservice-ce77cf42-96643323
  namespace: codeathon
spec:
  selector:
    matchLabels:
      serviceweaver/name: server-profile-profileservice-ce77cf42-96643323
  strategy: {}
  template:
    metadata:
      annotations:
        description: This Pod hosts components codeathon.runwayclub.dev/internal/profile/ProfileService.
      creationTimestamp: null
      labels:
        serviceweaver/app: server
        serviceweaver/name: server-profile-profileservice-ce77cf42-96643323
        serviceweaver/version: ce77cf42
      namespace: codeathon
    spec:
      affinity:
        podAntiAffinity:
          preferredDuringSchedulingIgnoredDuringExecution:
          - podAffinityTerm:
              labelSelector:
                matchLabels:
                  serviceweaver/name: server-profile-profileservice-ce77cf42-96643323
              topologyKey: kubernetes.io/hostname
            weight: 100
      containers:
      - args:
        - babysitter
        - /weaver/weaver.toml
        - /weaver/config.textpb
        - codeathon.runwayclub.dev/internal/profile/ProfileService
        image: docker.io/vominhtri1610/server:ce77cf42
        imagePullPolicy: IfNotPresent
        name: serviceweaver
        resources: {}
        stdin: true
        tty: true
        volumeMounts:
        - mountPath: /weaver/weaver.toml
          name: config
          subPath: weaver.toml
        - mountPath: /weaver/config.textpb
          name: config
          subPath: config.textpb
      dnsPolicy: ClusterFirst
      serviceAccountName: default
      volumes:
      - configMap:
          name: config-ce77cf42
        name: config
status: {}

---

# Autoscaler for group codeathon.runwayclub.dev/internal/profile/ProfileService
apiVersion: autoscaling/v2
kind: HorizontalPodAutoscaler
metadata:
  annotations:
    description: This HorizontalPodAutoscaler scales the "server-profile-profileservice-ce77cf42-96643323"
      Deployment.
  creationTimestamp: null
  labels:
    serviceweaver/app: server
    serviceweaver/version: ce77cf42
  name: server-profile-profileservice-ce77cf42-96643323
  namespace: codeathon
spec:
  maxReplicas: 10
  metrics:
  - resource:
      name: cpu
      target:
        averageUtilization: 80
        type: Utilization
    type: Resource
  minReplicas: 1
  scaleTargetRef:
    apiVersion: apps/v1
    kind: Deployment
    name: server-profile-profileservice-ce77cf42-96643323
status:
  currentMetrics: null
  desiredReplicas: 0

---

# Deployment for group codeathon.runwayclub.dev/internal/submission/SubmissionService
apiVersion: apps/v1
kind: Deployment
metadata:
  annotations:
    description: This Deployment hosts components codeathon.runwayclub.dev/internal/submission/SubmissionService.
  creationTimestamp: null
  labels:
    serviceweaver/app: server
    serviceweaver/version: ce77cf42
  name: server-submission-submissionservice-ce77cf42-8f8800f7
  namespace: codeathon
spec:
  selector:
    matchLabels:
      serviceweaver/name: server-submission-submissionservice-ce77cf42-8f8800f7
  strategy: {}
  template:
    metadata:
      annotations:
        description: This Pod hosts components codeathon.runwayclub.dev/internal/submission/SubmissionService.
      creationTimestamp: null
      labels:
        serviceweaver/app: server
        serviceweaver/name: server-submission-submissionservice-ce77cf42-8f8800f7
        serviceweaver/version: ce77cf42
      namespace: codeathon
    spec:
      affinity:
        podAntiAffinity:
          preferredDuringSchedulingIgnoredDuringExecution:
          - podAffinityTerm:
              labelSelector:
                matchLabels:
                  serviceweaver/name: server-submission-submissionservice-ce77cf42-8f8800f7
              topologyKey: kubernetes.io/hostname
            weight: 100
      containers:
      - args:
        - babysitter
        - /weaver/weaver.toml
        - /weaver/config.textpb
        - codeathon.runwayclub.dev/internal/submission/SubmissionService
        image: docker.io/vominhtri1610/server:ce77cf42
        imagePullPolicy: IfNotPresent
        name: serviceweaver
        resources: {}
        stdin: true
        tty: true
        volumeMounts:
        - mountPath: /weaver/weaver.toml
          name: config
          subPath: weaver.toml
        - mountPath: /weaver/config.textpb
          name: config
          subPath: config.textpb
      dnsPolicy: ClusterFirst
      serviceAccountName: default
      volumes:
      - configMap:
          name: config-ce77cf42
        name: config
status: {}

---

# Autoscaler for group codeathon.runwayclub.dev/internal/submission/SubmissionService
apiVersion: autoscaling/v2
kind: HorizontalPodAutoscaler
metadata:
  annotations:
    description: This HorizontalPodAutoscaler scales the "server-submission-submissionservice-ce77cf42-8f8800f7"
      Deployment.
  creationTimestamp: null
  labels:
    serviceweaver/app: server
    serviceweaver/version: ce77cf42
  name: server-submission-submissionservice-ce77cf42-8f8800f7
  namespace: codeathon
spec:
  maxReplicas: 10
  metrics:
  - resource:
      name: cpu
      target:
        averageUtilization: 80
        type: Utilization
    type: Resource
  minReplicas: 1
  scaleTargetRef:
    apiVersion: apps/v1
    kind: Deployment
    name: server-submission-submissionservice-ce77cf42-8f8800f7
status:
  currentMetrics: null
  desiredReplicas: 0

---

# Listener Service for group github.com/ServiceWeaver/weaver/Main
apiVersion: v1
kind: Service
metadata:
  annotations:
    description: This Service forwards traffic to the "server" listener.
  creationTimestamp: null
  labels:
    serviceweaver/app: server
    serviceweaver/listener: server
    serviceweaver/version: ce77cf42
  name: server-ce77cf42
  namespace: codeathon
spec:
  ports:
  - port: 80
    protocol: TCP
    targetPort: 20000
  selector:
    serviceweaver/name: server-weaver-main-ce77cf42-4d83b67f
  type: LoadBalancer
status:
  loadBalancer: {}

---

# Deployment for group github.com/ServiceWeaver/weaver/Main
apiVersion: apps/v1
kind: Deployment
metadata:
  annotations:
    description: This Deployment hosts components github.com/ServiceWeaver/weaver/Main.
  creationTimestamp: null
  labels:
    serviceweaver/app: server
    serviceweaver/version: ce77cf42
  name: server-weaver-main-ce77cf42-4d83b67f
  namespace: codeathon
spec:
  selector:
    matchLabels:
      serviceweaver/name: server-weaver-main-ce77cf42-4d83b67f
  strategy: {}
  template:
    metadata:
      annotations:
        description: This Pod hosts components github.com/ServiceWeaver/weaver/Main.
      creationTimestamp: null
      labels:
        serviceweaver/app: server
        serviceweaver/name: server-weaver-main-ce77cf42-4d83b67f
        serviceweaver/version: ce77cf42
      namespace: codeathon
    spec:
      affinity:
        podAntiAffinity:
          preferredDuringSchedulingIgnoredDuringExecution:
          - podAffinityTerm:
              labelSelector:
                matchLabels:
                  serviceweaver/name: server-weaver-main-ce77cf42-4d83b67f
              topologyKey: kubernetes.io/hostname
            weight: 100
      containers:
      - args:
        - babysitter
        - /weaver/weaver.toml
        - /weaver/config.textpb
        - github.com/ServiceWeaver/weaver/Main
        image: docker.io/vominhtri1610/server:ce77cf42
        imagePullPolicy: IfNotPresent
        name: serviceweaver
        ports:
        - containerPort: 20000
          name: server
        resources: {}
        stdin: true
        tty: true
        volumeMounts:
        - mountPath: /weaver/weaver.toml
          name: config
          subPath: weaver.toml
        - mountPath: /weaver/config.textpb
          name: config
          subPath: config.textpb
      dnsPolicy: ClusterFirst
      serviceAccountName: default
      volumes:
      - configMap:
          name: config-ce77cf42
        name: config
status: {}

---

# Autoscaler for group github.com/ServiceWeaver/weaver/Main
apiVersion: autoscaling/v2
kind: HorizontalPodAutoscaler
metadata:
  annotations:
    description: This HorizontalPodAutoscaler scales the "server-weaver-main-ce77cf42-4d83b67f"
      Deployment.
  creationTimestamp: null
  labels:
    serviceweaver/app: server
    serviceweaver/version: ce77cf42
  name: server-weaver-main-ce77cf42-4d83b67f
  namespace: codeathon
spec:
  maxReplicas: 10
  metrics:
  - resource:
      name: cpu
      target:
        averageUtilization: 80
        type: Utilization
    type: Resource
  minReplicas: 1
  scaleTargetRef:
    apiVersion: apps/v1
    kind: Deployment
    name: server-weaver-main-ce77cf42-4d83b67f
status:
  currentMetrics: null
  desiredReplicas: 0

---
